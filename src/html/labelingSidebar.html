<link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css">

<style type='text/css'>
#spinner {
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
}
#spinner {
  display:none;
  transform:scale(0.6);
  z-index: 10;
}
* {
    font-family: Arial;
}
@-webkit-keyframes uil-default-anim { 0% { opacity: 1} 100% {opacity: 0} }@keyframes uil-default-anim { 0% { opacity: 1} 100% {opacity: 0} }.uil-default-css > div:nth-of-type(1){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: -0.5s;animation-delay: -0.5s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(2){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: -0.4166666666666667s;animation-delay: -0.4166666666666667s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(3){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: -0.33333333333333337s;animation-delay: -0.33333333333333337s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(4){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: -0.25s;animation-delay: -0.25s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(5){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: -0.16666666666666669s;animation-delay: -0.16666666666666669s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(6){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: -0.08333333333333331s;animation-delay: -0.08333333333333331s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(7){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: 0s;animation-delay: 0s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(8){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: 0.08333333333333337s;animation-delay: 0.08333333333333337s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(9){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: 0.16666666666666663s;animation-delay: 0.16666666666666663s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(10){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: 0.25s;animation-delay: 0.25s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(11){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: 0.33333333333333337s;animation-delay: 0.33333333333333337s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}.uil-default-css > div:nth-of-type(12){-webkit-animation: uil-default-anim 1s linear infinite;animation: uil-default-anim 1s linear infinite;-webkit-animation-delay: 0.41666666666666663s;animation-delay: 0.41666666666666663s;}.uil-default-css { position: relative;background:none;width:200px;height:200px;}
</style>
<div id="spinner" class='uil-default-css'>
<div style='top:80px;left:93px;width:14px;height:40px;background:#9f4a6c;-webkit-transform:rotate(0deg) translate(0,-60px);transform:rotate(0deg) translate(0,-60px);border-radius:10px;position:absolute;'></div>
<div style='top:80px;left:93px;width:14px;height:40px;background:#9f4a6c;-webkit-transform:rotate(30deg) translate(0,-60px);transform:rotate(30deg) translate(0,-60px);border-radius:10px;position:absolute;'></div>
<div style='top:80px;left:93px;width:14px;height:40px;background:#9f4a6c;-webkit-transform:rotate(60deg) translate(0,-60px);transform:rotate(60deg) translate(0,-60px);border-radius:10px;position:absolute;'></div>
<div style='top:80px;left:93px;width:14px;height:40px;background:#9f4a6c;-webkit-transform:rotate(90deg) translate(0,-60px);transform:rotate(90deg) translate(0,-60px);border-radius:10px;position:absolute;'></div>
<div style='top:80px;left:93px;width:14px;height:40px;background:#9f4a6c;-webkit-transform:rotate(120deg) translate(0,-60px);transform:rotate(120deg) translate(0,-60px);border-radius:10px;position:absolute;'></div>
<div style='top:80px;left:93px;width:14px;height:40px;background:#9f4a6c;-webkit-transform:rotate(150deg) translate(0,-60px);transform:rotate(150deg) translate(0,-60px);border-radius:10px;position:absolute;'></div>
<div style='top:80px;left:93px;width:14px;height:40px;background:#9f4a6c;-webkit-transform:rotate(180deg) translate(0,-60px);transform:rotate(180deg) translate(0,-60px);border-radius:10px;position:absolute;'></div>
<div style='top:80px;left:93px;width:14px;height:40px;background:#9f4a6c;-webkit-transform:rotate(210deg) translate(0,-60px);transform:rotate(210deg) translate(0,-60px);border-radius:10px;position:absolute;'></div>
<div style='top:80px;left:93px;width:14px;height:40px;background:#9f4a6c;-webkit-transform:rotate(240deg) translate(0,-60px);transform:rotate(240deg) translate(0,-60px);border-radius:10px;position:absolute;'></div>
<div style='top:80px;left:93px;width:14px;height:40px;background:#9f4a6c;-webkit-transform:rotate(270deg) translate(0,-60px);transform:rotate(270deg) translate(0,-60px);border-radius:10px;position:absolute;'></div>
<div style='top:80px;left:93px;width:14px;height:40px;background:#9f4a6c;-webkit-transform:rotate(300deg) translate(0,-60px);transform:rotate(300deg) translate(0,-60px);border-radius:10px;position:absolute;'></div>
<div style='top:80px;left:93px;width:14px;height:40px;background:#9f4a6c;-webkit-transform:rotate(330deg) translate(0,-60px);transform:rotate(330deg) translate(0,-60px);border-radius:10px;position:absolute;'></div>
</div>
<div class="root">
<!--
<div class="widget">
  <fieldset>
    <legend>Filter Orders: </legend>
    <label for="radio-1">All</label>
    <input type="radio" name="radio-1" id="radio-1" checked="true">
    <label for="radio-1">Odd</label>
    <input type="radio" name="radio-1" id="radio-2">
    <label for="radio-2">Even</label>
    <input type="radio" name="radio-1" id="radio-3">
  </fieldset>
</div>
-->
<div class="orderListDiv">
  <ul id="orderList"></ul>
</div>
<div class="printerDiv">
  <fieldset>
    <legend>Printer:</legend>
    <i>Select which printer to send the document to:</i>
    <select id='printerOptions' >

    </select>
  </fieldset>
</div>
<div class="printDiv">
  <fieldset>
    <legend>Print Labels:</legend>
    <input type="number" min="0" max="9999" name="print" id="PrintOrderNumber" placeholder="e.g. 2047"/>
    <input type="button" name="print" value="Print" onclick="printLabel();"/>
    <!--upon submit, clear field -->
  </fieldset>
</div>

<div class="reprintDiv">
  <fieldset>
    <legend>Reprint Labels:</legend>
    <i>Note: reprinting labels will not change the order's state</i><br/>
    <input type="number" min="0" max="9999" name="reprint" id="ReprintOrderNumber" placeholder="e.g. 2051"/>
    <input type="button" name="reprint" value="Reprint" onclick="reprintLabel();"/>
    <!--upon submit, clear field -->
  </fieldset>
</div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
<script>
//TODO: onchange of radio-1 - apply filter on list
//TODO: write function that will call GAS to invoke cloud print API, change order state, remove from list
  $( function() {
//    $( "input" ).checkboxradio();
//    $( "fieldset" ).controlgroup();
  } );

  //TODO: should wait until document is "ready"?
  // get a list of available printers
  google.script.run.withSuccessHandler(printersAvailable).showPrinters(true);

  function printersAvailable(arg) {
  console.log(arg);
    var select = document.getElementById('printerOptions');
    for (var i in arg) {
      var option = document.createElement('option');
      option.text = arg[i].displayName;
      option.value = arg[i].id;
      select.appendChild(option);
    }
  }

  function validateOrderNumber(orderNumber) {
    if (orderNumber === null || orderNumber === undefined || orderNumber == "") {
      alert("Order Number not specified!");
      return false;
    }
    else return true;
  }

  var printLabel = function() {
    $("#spinner").show();
    $("#root").fadeTo(0,0.5);
    var order = document.getElementById('PrintOrderNumber');
    if (!validateOrderNumber(order.value)){
      $("#spinner").hide();
      return;
    }
    var select = document.getElementById('printerOptions');
    console.log(select.value);
    //TODO: need callback from server to confirm correct order_id to user ... it fails silently now
    google.script.run.withSuccessHandler(onSuccess).withFailureHandler(onFailure).printLabel(order.value, select.value);
    $(":input").prop("disabled", true);
  };

  var reprintLabel = function() {
    $("#spinner").show();
    $("#root").fadeTo(0,0.5);
    var order = document.getElementById('ReprintOrderNumber');
    if (!validateOrderNumber(order.value)){
      $("#spinner").hide();
      return;
    }
    var select = document.getElementById('printerOptions');

    //TODO: need callback from server to confirm correct order_id to user ... it fails silently now
    google.script.run.withSuccessHandler(onSuccess).withFailureHandler(onFailure).reprintLabel(order.value, select.value);
    $(":input").prop("disabled", true);
  };

  function onSuccess(result){
    $("#spinner").hide();
    document.getElementById('PrintOrderNumber').value = '';
    document.getElementById('ReprintOrderNumber').value = '';
    $(":input").prop("disabled", false);
  }
  function onFailure(e){
    $("#spinner").hide();
    alert(e);
    document.getElementById('PrintOrderNumber').value = '';
    document.getElementById('ReprintOrderNumber').value = '';
    $(":input").prop("disabled", false);
  }

</script>